<!DOCTYPE html>
<html>
  <head>
    <title>Backend Test</title>
    <script>
      async function checkHealth() {
        try {
          const response = await fetch("http://localhost:8000/health");
          const data = await response.json();
          document.getElementById("health").textContent =
            "Backend status: " + data.status;
          document.getElementById("health").style.color = "green";
        } catch (error) {
          document.getElementById("health").textContent =
            "Backend status: OFFLINE";
          document.getElementById("health").style.color = "red";
        }
      }

      async function submitForm() {
        const form = document.getElementById("uploadForm");
        const formData = new FormData(form);

        try {
          const response = await fetch("http://localhost:8000/process", {
            method: "POST",
            body: formData,
          });

          const result = await response.json();
          document.getElementById("result").textContent =
            result.structured_output;
        } catch (error) {
          document.getElementById("result").textContent =
            "Error: " + error.message;
        }
      }

      // Check health on page load
      window.onload = checkHealth;
    </script>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      button {
        padding: 8px 16px;
        background: #4285f4;
        color: white;
        border: none;
        border-radius: 4px;
      }
      #result {
        white-space: pre-wrap;
        background: #f5f5f5;
        padding: 15px;
        margin-top: 20px;
      }
      h1 {
        color: #333;
      }
      #health {
        font-weight: bold;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Backend Test</h1>
    <div id="health">Checking backend status...</div>

    <form id="uploadForm">
      <div class="form-group">
        <label for="query">Query:</label>
        <input
          type="text"
          id="query"
          name="query"
          required
          style="width: 100%; padding: 8px"
        />
      </div>

      <div class="form-group">
        <label for="files">Files:</label>
        <input type="file" id="files" name="files" multiple />
      </div>

      <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <div id="result"></div>
  </body>
</html>
